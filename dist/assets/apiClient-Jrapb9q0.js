const l="http://localhost:3001/api";async function i(r,o={}){const n=r.startsWith("http")?r:`${l}${r.startsWith("/")?r:`/${r}`}`;console.log(`ðŸ”¹ API Request: ${o.method||"GET"} ${n}`),o.body&&console.log("Request Body:",typeof o.body=="string"?JSON.parse(o.body):o.body);try{const t=await fetch(n,{...o,headers:{"Content-Type":"application/json",...o.headers}});console.log(`ðŸ”¸ API Response: ${t.status} ${t.statusText} for ${n}`),console.log("Response Headers:",{"content-type":t.headers.get("content-type"),"content-length":t.headers.get("content-length")});const c=t.clone();if(!t.ok)try{const s=t.headers.get("content-type");if(s&&s.includes("application/json")){const e=await t.json();throw console.error("API Error Response (JSON):",e),new Error(e.error||e.message||"API request failed")}else{const e=await t.text();throw console.error("API Error Response (Text):",e.substring(0,500)+(e.length>500?"...":"")),new Error("API request failed with non-JSON response")}}catch(s){throw console.error("Error parsing error response:",s),new Error(`API request failed: ${t.status} ${t.statusText}`)}try{const s=t.headers.get("content-type");if(s&&s.includes("application/json")){const e=await t.json();return console.log("API Success Response:",e),e}else{const e=await t.text();return console.log("API Success Response (Text):",e.substring(0,500)+(e.length>500?"...":"")),e}}catch(s){console.error("Error parsing success response:",s);try{const e=await c.text();console.error("Raw response text:",e.substring(0,500)+(e.length>500?"...":""))}catch(e){console.error("Could not get raw response text:",e)}throw new Error("Failed to parse API response")}}catch(t){throw console.error(`API Fetch Error for ${n}:`,t),t}}function a(r,o,n={}){return i(r,{...n,method:"POST",body:JSON.stringify(o)})}const u={login:(r,o)=>a("/auth/login",{email:r,password:o}),verifyToken:r=>a("/auth/verify-token",{token:r}),logout:()=>a("/auth/logout",{})};export{a as apiPost,u as authApi};
